% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sip.R
\name{SIP.acf}
\alias{SIP.acf}
\title{SIP Autocorrelation / Autocovariance (with optional plot)}
\usage{
SIP.acf(
  x,
  lag.max,
  type = "correlation",
  plot = TRUE,
  estimation = TRUE,
  ci.level = 0.95,
  main = NULL
)
}
\arguments{
\item{x}{Numeric vector. Input time series (same role as \code{seq} in \code{\link{SIP.test}}).}

\item{lag.max}{Integer (\eqn{\ge} 0). Maximum lag to estimate/display.}

\item{type}{Character. Either \code{"correlation"} or \code{"covariance"}.
Defaults to \code{"correlation"}.}

\item{plot}{Logical. If \code{TRUE}, produce the ACF-style plot with CI bands.
Defaults to \code{TRUE}.}

\item{estimation}{Logical. If \code{TRUE}, uses the same \code{lag.max} to compute
all lags (estimation-focused). If \code{FALSE}, uses lag-specific Y vector to compute each lagâ€™s
autocovariance but yields the \strong{same} confidence interval width across lags. Defaults to \code{TRUE}.}

\item{ci.level}{Numeric in (0, 1). Confidence level for CI bands when \code{plot = TRUE}.
Defaults to \code{0.95}.}

\item{main}{Optional character. Plot title.}
}
\value{
A list with components:
\describe{
\item{acf}{Numeric vector of estimated values for lags \code{0:lag.max}.}
\item{type}{The requested type (\code{"correlation"} or \code{"covariance"}).}
\item{n.used}{Effective sample size used in estimation.}
\item{lag}{Integer vector \code{0:lag.max}.}
\item{series}{Character label for the series (if available).}
\item{h0.ci}{CI half-width under the reference (white-noise) model at \code{ci.level}.}
}
If \code{plot = TRUE}, this object is returned \emph{invisibly} after plotting.
}
\description{
Computes (and optionally plots) sample autocorrelation or autocovariance
up to \code{lag.max}. Two modes are provided:
\itemize{
\item \strong{Estimation-focused} (\code{estimation = TRUE}): uses a common
\code{lag.max} for estimating all lags, typically yielding more precise
estimates;
\item \strong{Inference-focused} (\code{estimation = FALSE}): uses lag-specific
windows for each lag, producing the same CI width across lags.
}
}
\examples{
set.seed(1)
x <- rnorm(100) + c(rep(1, 50), rep(0, 50))
# Estimation-focused ACF (common lag.max for all lags)
SIP.acf(x, lag.max = 20, type = "correlation", estimation = TRUE, plot = TRUE)
# Inference-focused ACF (same CI width across lags)
SIP.acf(x, lag.max = 20, type = "correlation", estimation = FALSE, plot = TRUE)

}
\seealso{
\code{\link{SIP.test}}, \code{\link{ACF_est}}, \code{\link{ACF_inf}}
}
