% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sip.R
\name{SIP.acf}
\alias{SIP.acf}
\title{SIP Autocorrelation / Autocovariance (with optional plot)}
\usage{
SIP.acf(
  x,
  lag.max = 4,
  type = "correlation",
  plot = TRUE,
  estimation = FALSE,
  ci.level = 0.95,
  main = NULL
)
}
\arguments{
\item{x}{Numeric vector. Input time series (same role as \code{seq} in \code{\link{SIP.test}}).}

\item{lag.max}{Integer (\eqn{\ge} 0). Maximum lag to estimate/display. Default to \code{4}.}

\item{type}{Character. Either \code{"correlation"} or \code{"covariance"}.
Default to \code{"correlation"}.}

\item{plot}{Logical. If \code{TRUE}, produce the ACF-style plot with CI bands.
Default to \code{TRUE}.}

\item{estimation}{Logical. If \code{TRUE}, use the same \code{lag.max} to compute
all lags (estimation-focused). If \code{FALSE}, use lag-specific Y vector to compute each lagâ€™s
autocovariance but yield the \strong{same} confidence interval width across lags. Default to \code{TRUE}.}

\item{ci.level}{Numeric in (0, 1). Confidence level for CI bands when \code{plot = TRUE}.
Default to \code{0.95}.}

\item{main}{Optional character. Plot title.}
}
\value{
A list with components:
\describe{
\item{acf}{Numeric vector of estimated values for lags \code{0:lag.max}.}
\item{type}{The requested type (\code{"correlation"} or \code{"covariance"}).}
\item{n.used}{Effective sample size used in estimation.}
\item{lag}{Integer vector \code{0:lag.max}.}
\item{series}{Character label for the series (if available).}
\item{h0.ci}{CI half-width under the reference (white-noise) model at \code{ci.level}.}
}
If \code{plot = TRUE}, this object is returned \emph{invisibly} after plotting.
}
\description{
SIP.acf computes (and optionally plots) sample autocorrelation or autocovariance
up to \code{lag.max}. Two modes are provided:
\itemize{
\item \strong{Estimation-focused} (\code{estimation = TRUE}): use a common
\code{lag.max} for estimating all lags, typically yielding more precise
estimates;
\item \strong{Inference-focused} (\code{estimation = FALSE}): use lag-specific
windows for each lag, producing the same CI width across lags.
}
}
\examples{
## IID case
set.seed(1)
y <- rnorm(1000) + rep(c(rep(1, 50), rep(0, 50)), 10)
SIP.acf(y)  # defaults: lag.max = 4, type = "correlation", estimation = FALSE
acf(y) # for comparison with default acf

## MA(1) alternative with mean shifts (theta = 0.3)
set.seed(1)
e <- rnorm(1001)
x <- e[-1] + 0.3 * e[-1001]
y <- x + rep(c(rep(1, 50), rep(0, 50)), 10)
SIP.acf(y)

}
\references{
Liu, Z., Hao, N., Niu, Y. S., Xiao, H., & Ding, H. (2025) Autocorrelation Test under Frequent Mean. arXiv:2510.21047
}
\seealso{
\code{\link{SIP.test}}
}
